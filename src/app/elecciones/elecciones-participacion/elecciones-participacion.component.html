<!-- Main modal -->
<div id="authentication-modal" tabindex="-1" aria-hidden="true"
    class="fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-75 scrollable"
    [class.hidden]="!isVisible">
    <!-- MODIFICACIÓN CLAVE: Cambiado de max-w-md a max-w-6xl para un ancho mucho mayor -->
    <div class="relative p-4 w-full max-w-6xl max-h-full">
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow" style="color: rgb(5, 44, 101);">
            <div class="px-5 pt-5 flex justify-end">
                <!-- Se asume que 'closeModal()' y 'isVisible' existen en el componente TS si se usa esta estructura de modal -->
                <button type="button" (click)="closeModal()"
                    class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>

            <!-- Modal body -->
            <div>

                <main class="main-content">

                    <div class="max-w-7xl mx-auto">

                        <header class="flex justify-between items-center mb-8 p-4 border-b border-gray-200">

                            <!-- Contenedor del Título y Subtítulo (Elemento Izquierdo) -->
                            <div>
                                <h1
                                    class="text-4xl font-extrabold text-gray-800 border-b-4 border-indigo-600 pb-2 mb-2 inline-block">
                                    Resultados: {{ NombreEleccion }}
                                </h1>
                                <p class="text-lg text-gray-600 mt-2">Resumen de participación y conteo de votos por
                                    candidato.
                                </p>
                            </div>
                        </header>

                        <!-- Sección Superior: Métricas Clave (Cards) -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-12">

                            <!-- Tarjeta: Porcentaje de votos -->
                            <div
                                class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-gray-500 transition duration-300 hover:shadow-xl">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">
                                            Porcentaje de Votos Emitidos
                                        </p>
                                        <p id="total-votos" class="text-4xl font-bold text-gray-900 mt-1">
                                            {{ participacionData?.porcentajeParticipantes }}
                                        </p>
                                    </div>
                                    <div class="p-3 bg-gray-100 rounded-full text-gray-600">
                                        <!-- Icono de Gráfico de Pastel (Porcentaje) -->
                                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"></path>
                                        </svg>
                                    </div>
                                </div>
                            </div>

                            <!-- Tarjeta: Total de Votos Emitidos -->
                            <div
                                class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-green-500 transition duration-300 hover:shadow-xl">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">
                                            Votos Emitidos
                                        </p>
                                        <p id="total-votos" class="text-4xl font-bold text-gray-900 mt-1">
                                            {{ participacionData?.totalParticipantes }}
                                        </p>
                                    </div>
                                    <div class="p-3 bg-green-100 rounded-full text-green-600">
                                        <!-- Icono de Voto -->
                                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                    </div>
                                </div>
                            </div>

                            <!-- Tarjeta: Total de No Votantes -->
                            <div
                                class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-red-500 transition duration-300 hover:shadow-xl">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">
                                            No Votantes
                                        </p>
                                        <p id="total-no-votantes" class="text-4xl font-bold text-gray-900 mt-1">
                                            {{ participacionData?.totalNoParticipantes }}
                                        </p>
                                    </div>
                                    <div class="p-3 bg-red-100 rounded-full text-red-600">
                                        <!-- Icono de No Votante -->
                                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636">
                                            </path>
                                        </svg>
                                    </div>
                                </div>
                            </div>

                            <!-- Tarjeta: Total de Votantes Inscritos (¡Icono y colores cambiados!) -->
                            <div
                                class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-indigo-500 transition duration-300 hover:shadow-xl">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">
                                            Votantes Inscritos
                                        </p>
                                        <p id="total-votantes-inscritos" class="text-4xl font-bold text-gray-900 mt-1">
                                            {{ participacionData?.totalVotantes }}
                                        </p>
                                    </div>
                                    <div class="p-3 bg-indigo-100 rounded-full text-indigo-600">
                                        <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                            stroke="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
                                        </svg>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <br>
                        <div class="max-w-4xl mx-auto">

                            <!-- 
        CORRECCIÓN: Se debe verificar que 'votosResultados' exista (no sea null) 
        Y, crucialmente, que su longitud sea MAYOR que cero.
    -->
                            @if (votosResultados?.length === 0) {

                            <div
                                class="p-10 text-center bg-red-50 border-2 border-red-300 rounded-xl transition duration-300 ease-in-out shadow-md">
                                <svg class="w-16 h-16 mx-auto text-red-500 mb-4" fill="none" stroke="currentColor"
                                    viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <!-- Icono de alerta -->
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.3 16c-.77 1.333.192 3 1.732 3z">
                                    </path>
                                </svg>
                                <p class="text-xl font-bold text-red-700">¡Atención!</p>
                                <p class="mt-2 text-lg text-red-600">No hay candidatos registrados o datos de votación
                                    disponibles para esta
                                    elección.
                                </p>
                            </div>
                            } @else {
                            <div class="bg-white p-6 rounded-xl shadow-lg">
                                <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b pb-2">Votos por candidato
                                </h2>
                                <canvas id="votosChart"></canvas>
                            </div>
                            }

                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>
</div>